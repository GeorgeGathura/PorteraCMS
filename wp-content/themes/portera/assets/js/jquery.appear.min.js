/*
 * jQuery.appear
 * http://code.google.com/p/jquery-appear/
 * Copyright (c) 2012 Michael Hixson
 * Licensed under the MIT license
 */
(function ($) {
  $.fn.appear = function (fn, options) {
    var settings = $.extend(
      { data: undefined, one: true, accX: 0, accY: 0 },
      options,
    );
    return this.each(function () {
      var t = $(this);
      t.appeared = false;
      if (!fn) {
        t.trigger("appear", settings.data);
        return;
      }
      var w = $(window);
      var check = function () {
        if (!t.is(":visible")) {
          t.appeared = false;
          return;
        }
        var a = w.scrollLeft();
        var b = w.scrollTop();
        var o = t.offset();
        var x = o.left;
        var y = o.top;
        var ax = settings.accX;
        var ay = settings.accY;
        var th = t.height();
        var wh = w.height();
        var tw = t.width();
        var ww = w.width();
        if (
          y + th + ay >= b &&
          y <= b + wh + ay &&
          x + tw + ax >= a &&
          x <= a + ww + ax
        ) {
          if (!t.appeared) {
            t.trigger("appear", settings.data);
          }
          t.appeared = true;
        } else {
          t.appeared = false;
        }
      };
      var modifiedCheck = function () {
        t.appeared = false;
        check();
      };
      w.on("scroll", check);
      $(document).on("resize", check);
      if (settings.one) {
        t.one("appear", fn);
      } else {
        t.on("appear", fn);
      }
      $(document).ready(check);
    });
  };
})(jQuery);
